---
sidebar_position: 3
---

# Docker

Stalwart Mail server is available as a Docker image that includes JMAP, IMAP, and SMTP servers. To get started, pull the `mail-server:latest` image, for example:

```bash
$ docker pull stalwartlabs/mail-server:latest
```

Then, create a directory on your host machine where you will store the configuration files and the data for the mail server, for example:

```bash
$ mkdir /var/lib/stalwart-mail
```

Once you have completed the setup instructions, start the Stalwart Mail server container:

```bash
$ docker run -d -ti -p 443:443 -p 8080:8080 \
             -p 25:25 -p 587:587 -p 465:465 \
             -p 143:143 -p 993:993 -p 4190:4190 \
             -p 110:110 -p 995:995 \
             -v <STALWART_DIR>:/opt/stalwart-mail \
             --name stalwart-mail stalwartlabs/mail-server:latest
```

Make sure to replace `<STALWART_DIR>` with the path to the directory you created above. Please note that it is not necessary to expose all these ports, read the [get started](/docs/get-started#choosing-network-ports) documentation for more information.

### Log in to the web interface

Execute `docker logs stalwart-mail` to obtain the system administrator account and password: 

```bash
$ docker logs stalwart-mail
âœ… Configuration file written to /opt/stalwart-mail/etc/config.toml
ðŸ”‘ Your administrator account is 'admin' with password 'w95Yuiu36E'.
```

With this information, you can log in to the web interface at `http://yourserver.org:8080/login`.

### Choose where to store your data

Once you have logged in, go to the `Settings` > `Storage` section and configure your [data](/docs/storage/data), [blob](/docs/storage/blob), [full-text](/docs/storage/fts) and [lookup](/docs/storage/lookup) stores. Read the [get started](/docs/get-started#choosing-storage-backends) section for more details on the available options. 

If you would like an external authentication directory such as [LDAP](/docs/auth/directory/ldap.md) or [SQL](/docs/auth/directory/sql), go to the `Settings` > `Authentication` section and configure your [authentication backend](/docs/get-started#supported-authentication-backends).

:::tip Optional

Stalwart Mail Server comes pre-configured with `RocksDB` as the default backend for all stores. You can skip this step if you are happy with the default configuration.

:::

### Configure your hostname and domain

Next, make sure that the server hostname in `Settings` > `Server` > `Network` is correct. Then, add your main domain name in `Management` > `Directory` > `Domains`. After creating the domain, the interface will display the DNS records that you need to add to your domain's DNS settings. 

For example:

```txt
MX  example.org.                      10 mail.example.org.
TXT 202404e._domainkey.example.org.   v=DKIM1; k=ed25519; h=sha256; p=MCowBQYDK2VwAyEAOT2JN9F8SLTVFNEODDu22SD9RJDC282mugCAeXkzjH0=
TXT 202404r._domainkey.example.org.   v=DKIM1; k=rsa; h=sha256; p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAykeYJjv5N0AlnJ8gKF+/8qjbStiMFWvPg+p3JPh96GPXEN6l9W/Ee6Lag6i3vLyTVH5dnRVRBhfWhc+Dc0nKreZe4f5i4L5M4RI31+RpEgu4bCmncUIk2WzJgGBW5XbiOwXjge6OKWtJQN9d8Lc1AuryL5xeged9iS6xd/+EJz4WxAf18U+j38xmAm8fJUTBnQVeb/AZup+voSKAS59jyumsb0jQtXfX5xnwTFXdiX2OF8LRrmmNs/ObHozgHftxAv+YCiSU4bqSlKNPQIrN5kk1YnZDnLlc1Gr66AWlmdUVE7PWtZPTy4f8+uHO93EW3WUxLmynZm+Syn9FTJC2uwIDAQAB
TXT mail.example.org.                 v=spf1 a -all ra=postmaster
TXT example.org.                      v=spf1 mx -all ra=postmaster
TXT _dmarc.example.org.               v=DMARC1; p=reject; rua=mailto:postmaster@example.org; ruf=mailto:postmaster@example.org
```

:::tip 

Some of the autogenerated records may be optional depending on your setup, read the [understanding DNS records](/docs/get-started#understanding-dns-records) section for more information.

:::

### Enable TLS

Stalwart Mail Server requires a valid TLS certificate to secure the connection between the server and the client. You can enable TLS in one of the following ways:

- If you already have a TLS certificate for your server, you can upload it in the `Settings` > `Server` > `TLS` > `Certificates` section. 
- If you don't have a certificate, you can enable automatic TLS certificates from Let's Encrypt using [ACME](/docs/server/tls/acme/overview). To enable ACME, go to the `Settings` > `Server` > `TLS` > `ACME Providers` section and add Let's Encrypt as your ACME provider making sure that your server hostname is listed as one of the Subject Names. Stalwart supports the `tls-alpn-01`, `dns-01` and `http-01` challenges, if you are unsure which one to use, read the [ACME challenge types](/docs/server/tls/acme/challenges) documentation.
- If you are running Stalwart behind a [reverse proxy](/docs/server/reverse-proxy/overview) such as Traefik, Caddy, HAProxy or NGINX, you should skip this step and configure TLS in your reverse proxy instead.

### Restart the container

Once you have completed the setup instructions, restart the container:

```bash
$ docker restart stalwart-mail
```

### Next steps

If you have selected to use the internal directory, you can now add your users in the `Management` > `Directory` > `Accounts` section. If you have selected an external directory, you will need to create users in your directory server.

If everything went well, your users should now be able to connect to the server and send and receive emails. If you are unable to connect to the server, check the log files from the web-admin or under `<INSTALL_DIR>/logs` for any errors.

If you have questions please check the [FAQ](/docs/faq) section or start a discussion in the [community forum](https://github.com/stalwartlabs/mail-server/discussions).

:::tip 

Before making your server publicly accessible, it is advisable to disable any [unused services](/docs/get-started#choosing-network-ports) to enhance security.

:::

### Setup demonstration

![Setup screencast](/img/screencast-setup.gif)
